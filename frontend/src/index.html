<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Roadmap Frontend</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Roboto, Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    h1 { color: #333; margin-bottom: 20px; }
    h2 { color: #666; font-size: 1.2em; margin: 20px 0 10px 0; }
    .section { margin: 20px 0; padding: 15px; background: #fafafa; border-radius: 6px; }
    input, textarea { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; }
    button { padding: 10px 16px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
    button:hover { background: #0056b3; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    ul { list-style: none; }
    li { padding: 12px; margin: 8px 0; background: white; border-left: 4px solid #007bff; border-radius: 4px; }
    .loading { text-align: center; color: #666; font-style: italic; }
    .error { color: #d32f2f; padding: 10px; background: #ffebee; border-radius: 4px; margin: 10px 0; }
    .success { color: #388e3c; padding: 10px; background: #e8f5e9; border-radius: 4px; margin: 10px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸ“‹ Roadmaps</h1>
    
    <div class="section">
      <h2>Crear Roadmap</h2>
      <div>
        <label for="title">TÃ­tulo:</label>
        <input id="title" type="text" placeholder="Ej: MVP v1.0">
      </div>
      <div>
        <label for="description">DescripciÃ³n:</label>
        <textarea id="description" placeholder="Ej: Primera versiÃ³n con autenticaciÃ³n"></textarea>
      </div>
      <button onclick="createRoadmap()">Crear</button>
      <div id="message"></div>
    </div>

    <div class="section">
      <h2>Lista de Roadmaps</h2>
      <div id="list" class="loading">Cargando...</div>
    </div>
  </div>

  <script>
    const API_BASE = '/api/roadmaps';

    function createRoadmap() {
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const msgDiv = document.getElementById('message');

      if (!title) {
        msgDiv.innerHTML = '<div class="error">El tÃ­tulo es obligatorio</div>';
        return;
      }

      const btn = event.target;
      btn.disabled = true;

      fetch(API_BASE, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, description })
      })
      .then(r => r.json())
      .then(data => {
        msgDiv.innerHTML = '<div class="success">âœ“ Roadmap creado: ' + data.title + '</div>';
        document.getElementById('title').value = '';
        document.getElementById('description').value = '';
        loadRoadmaps();
        setTimeout(() => { msgDiv.innerHTML = ''; }, 3000);
      })
      .catch(err => {
        msgDiv.innerHTML = '<div class="error">Error: ' + err.message + '</div>';
      })
      .finally(() => { btn.disabled = false; });
    }

    function loadRoadmaps() {
      const listDiv = document.getElementById('list');
      listDiv.innerHTML = '<div class="loading">Cargando...</div>';

      fetch(API_BASE)
        .then(r => r.json())
        .then(data => {
          if (data.length === 0) {
            listDiv.innerHTML = '<div class="loading">No hay roadmaps aÃºn. Â¡Crea uno!</div>';
          } else {
            listDiv.innerHTML = '<ul>' + data.map(r => 
              '<li><strong>' + r.title + '</strong><br><small>' + r.description + '</small><br><em style="color:#999;font-size:0.9em">ID: ' + r.id.substring(0, 8) + '...</em></li>'
            ).join('') + '</ul>';
          }
        })
        .catch(err => {
          listDiv.innerHTML = '<div class="error">Error al cargar: ' + err.message + '</div>';
        });
    }

    // Load on page load
    window.onload = loadRoadmaps;
  </script>
</body>
</html>
